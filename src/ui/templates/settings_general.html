{% set current_endpoint = url_for(request.endpoint)[1:].split("/")[-1].strip().replace('_', '-')
%}
<!-- plugin item -->
{% set plugins = config["CONFIG"].get_plugins() %} 
{% set global_config = config["CONFIG"].get_config() %} 
  <!-- general container -->
  <div {{current_endpoint}}-item="general" class="w-full">
    <!-- general conf -->
    <div class="col-span-12" setting-header>
      <h5 class="transition duration-300 ease-in-out dark:opacity-90 ml-2 font-bold text-md uppercase dark:text-white mb-0">GENERAL</h5>
      <div class="transition duration-300 ease-in-out dark:opacity-90 ml-2 text-sm mb-2 dark:text-gray-400">
        General config : HTTP, DNS, LOG, API...
        </div>
    </div>
    <div
      {{current_endpoint}}-settings
        class="w-full grid grid-cols-12"
        id="edit-{{current_endpoint}}-general"
      >
        {% for
        setting, value in config["CONFIG"].get_settings().items() %} {%
        if current_endpoint == "global-config" and value["context"] == "global" and "label" in value %}
        <div setting-container
          class="mx-0 sm:mx-4 my-2 col-span-12 md:mx-6 md:my-3  md:col-span-6 2xl:col-span-4 xl:mx-4 2xl:my-2 3xl:col-span-3"
          id="form-edit-{{current_endpoint}}-{{ value["id"] }}"
        >
        <!-- title and info -->
        <div class="flex items-center my-1 relative">
          <h5 class="transition duration-300 ease-in-out dark:opacity-90 text-sm sm:text-md font-bold m-0 dark:text-gray-300">{{value["label"]}}</h5>
          <svg
          {{current_endpoint}}-info-btn="{{ value["label"] }}"
          class="cursor-pointer fill-blue-500 h-5 w-5 ml-2 hover:brightness-75"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 512 512"
        >
          <path
            d="M256 512c141.4 0 256-114.6 256-256S397.4 0 256 0S0 114.6 0 256S114.6 512 256 512zM216 336h24V272H216c-13.3 0-24-10.7-24-24s10.7-24 24-24h48c13.3 0 24 10.7 24 24v88h8c13.3 0 24 10.7 24 24s-10.7 24-24 24H216c-13.3 0-24-10.7-24-24s10.7-24 24-24zm40-144c-17.7 0-32-14.3-32-32s14.3-32 32-32s32 14.3 32 32s-14.3 32-32 32z"
          />
        </svg> 
        <!-- popover -->
          <div  class="hidden transition z-50 rounded-md p-3 left-0 -translate-y-7 bottom-0 absolute bg-blue-500"
          {{current_endpoint}}-info-popover="{{ value["label"] }}"
         >
          <p  class="transition duration-300 ease-in-out dark:opacity-90 font-bold text-sm text-white m-0" >             {{value['help']}}
          </p>
          </div>
        <!-- end popover -->
        </div>
        <!-- end title and info -->
    <!-- input -->
    {% if value["type"] != "select" and value["type"] != "check" %}
    <input default-value="{{value['default']}}" {% if global_config[setting]['method'] != 'ui' and global_config[setting]['method'] != 'default'  %} disabled {% endif %} id="{{setting}}" name="{{setting}}" 
     class="duration-300 ease-in-out dark:opacity-90 dark:border-slate-600 dark:bg-slate-700 dark:text-gray-300 disabled:opacity-75 focus:valid:border-green-500 focus:invalid:border-red-500 outline-none focus:border-primary text-sm leading-5.6 ease block w-full appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding px-1.5 py-1 md:px-3 md:py-2 font-normal text-gray-700 transition-all placeholder:text-gray-500 disabled:bg-gray-400 dark:disabled:bg-gray-800 dark:disabled:border-gray-800 dark:disabled:text-gray-300 disabled:text-gray-700"
    value="{% if global_config[setting]['value'] %} {{global_config[setting]['value']}} {% else %} {{value['default']}} {% endif %}" type="{{value['type']}}"  pattern="{{value['regex']|safe}}" />
    {% endif %}
    <!-- end input -->

    <!-- select -->
    {% if value["type"] == "select" %}
    <!-- default hidden-->
      <select  id="{{setting}}" name="{{setting}}" {{current_endpoint}}-setting-select-default="{{value['id']}}" type="form-select" id="{{setting}}" name="{{setting}}"
        class="hidden">
        {% for item in value['select'] %}
        <option value="{{item}}" {% if global_config[setting]['value'] and global_config[setting]['value'] == item or not global_config[setting]['value'] and value['default'] == item %} selected{% endif %}>{{item}}</option>
        {% endfor %}
    </select>
    <!-- end default hidden-->

    <!--custom-->
    <div class="relative">
      {% for item in value['select'] %}
      {% if global_config[setting]['value'] and global_config[setting]['value'] == item %}
      <button
      default-value="{{value['default']}}"
      {{current_endpoint}}-setting-select="{{value['id']}}"
      value="{{global_config[setting]['value']}}"
      type="button"
      {% if global_config[setting]['method'] != 'ui' and global_config[setting]['method'] != 'default'  %} disabled {% endif %}      class="disabled:opacity-75 dark:disabled:text-gray-300 disabled:text-gray-700 disabled:bg-gray-400 disabled:border-gray-400 dark:disabled:bg-gray-800 dark:disabled:border-gray-800 duration-300 ease-in-out dark:opacity-90 dark:border-slate-600 dark:bg-slate-700 dark:text-gray-300 focus:border-green-500 flex justify-between align-middle items-center text-left text-sm leading-5.6 ease  w-full  rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding px-1.5 py-1 md:px-3 md:py-2 font-normal text-gray-700 transition-all placeholder:text-gray-500"
    >
      {{global_config[setting]['value']}}
       <!-- chevron -->
       <svg
       {{current_endpoint}}-setting-select="{{value['id']}}"
         class="transition-transform h-4 w-4 fill-gray-500"
         xmlns="http://www.w3.org/2000/svg"
         viewBox="0 0 512 512"
       >
         <path
           d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"
         />
       </svg>
       <!-- end chevron -->
    </button>
      {% elif not global_config[setting]['value'] and value['default'] == item %}
      <button
      {{current_endpoint}}-setting-select="{{value['id']}}"
      value="{{value['default']}}"
      type="button"
      class="duration-300 ease-in-out dark:opacity-90 dark:border-slate-600 dark:bg-slate-700 dark:text-gray-300 focus:border-green-500 flex justify-between align-middle items-center text-left text-sm leading-5.6 ease  w-full  rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding px-1.5 py-1 md:px-3 md:py-2 font-normal text-gray-700 transition-all placeholder:text-gray-500"
    >
    {{value['default']}}
       <!-- chevron -->
       <svg
       {{current_endpoint}}-setting-select="{{value['id']}}"
         class="transition-transform h-4 w-4 fill-gray-500"
         xmlns="http://www.w3.org/2000/svg"
         viewBox="0 0 512 512"
       >
         <path
           d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"
         />
       </svg>
       <!-- end chevron -->
    </button>
      {% endif %}
      {% endfor %}
    
      <!-- dropdown-->
      <div
      {{current_endpoint}}-setting-select-dropdown="{{value['id']}}"
      class="hidden z-100 absolute h-full flex-col w-full mt-2 "
    >
        {% for item in value['select'] %}
        {% if global_config[setting]['value'] and global_config[setting]['value'] == item or not global_config[setting]['value'] and value['default'] == item %}
        <button type="button" value="{{item}}"  {{current_endpoint}}-setting-select-dropdown-btn="{{value['id']}}" type="button" class="{% if loop.index == 1 %} border-t rounded-t {% endif %} {% if loop.index == loop.length %}rounded-b {% endif %} border-b border-l border-r border-gray-300 dark:hover:brightness-90 hover:brightness-90 bg-primary dark:bg-primary my-0 relative px-6 py-2  text-center  align-middle transition-all rounded-none cursor-pointer leading-normal text-sm ease-in tracking-tight-rem dark:border-slate-600  dark:text-gray-300 text-gray-300"
        >{{item}}</button>
        {% else %}
        <button type="button"  value="{{item}}"   {{current_endpoint}}-setting-select-dropdown-btn="{{value['id']}}" type="button" class="{% if loop.index == 1 %} border-t rounded-t {% endif %} {% if loop.index == loop.length %}rounded-b {% endif %} border-b border-l border-r border-gray-300 dark:hover:brightness-90 hover:brightness-90  bg-white text-gray-700 my-0 relative px-6 py-2  text-center  align-middle transition-all rounded-none cursor-pointer leading-normal text-sm ease-in tracking-tight-rem dark:border-slate-600 dark:bg-slate-700 dark:text-gray-300"
            >{{item}}</button>
        {% endif %}
        {% endfor %}

    </div>
    <!-- end dropdown-->
    </div>
  <!-- end custom-->
        {% endif %}

      <!-- checkbox -->
      {% if value["type"] == "check" %}
      <div checkbox-handler="{{value['id']}}" class="relative mb-7 md:mb-0">
        <input  id="{{setting}}" name="{{setting}}"   
        default-method="{{global_config[setting]['method']}}" default-value="{{value['default']}}"
        {% if global_config[setting]['method'] != 'ui' or global_config[setting]['method'] != 'default'  %} disabled {% endif %}
          {% if global_config[setting]['value'] and global_config[setting]['value'] == 'yes' or not global_config[setting]['value'] and value['default'] == 'yes' %} checked  {% endif %} id="checkbox-{{value['id']}}" 
        class="relative {% if global_config[setting]['method'] != 'ui' and global_config[setting]['method'] != 'default'  %} pointer-events-none {% else %}	cursor-pointer {% endif %} dark:border-slate-600 dark:bg-slate-700 z-10 checked:z-0 w-5 h-5 ease text-base  rounded-1.4 checked:bg-primary checked:border-primary dark:checked:bg-primary dark:checked:border-primary  duration-250 float-left mt-1 appearance-none border border-gray-300 bg-white bg-contain bg-center bg-no-repeat align-top transition-all disabled:bg-gray-400 disabled:border-gray-400 dark:disabled:bg-gray-800 dark:disabled:border-gray-800 disabled:text-gray-700 dark:disabled:text-gray-300" 
        type="checkbox"
        pattern="{{value['regex']|safe}}"
        value="{% if global_config[setting]['value'] %} {{global_config[setting]['value']}} {% else %} {{value['default']}} {% endif %}"
        />
        <svg checkbox-handler="{{value['id']}}" class="{% if global_config[setting]['method'] != 'ui' and global_config[setting]['method'] != 'default'  %} pointer-events-none {% else %}	cursor-pointer {% endif %} absolute fill-white dark:fill-gray-300 left-0 top-0 translate-x-1 translate-y-2 h-3 w-3 " xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
        <path   d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path>
        </svg>
      </div>
      {% endif %}
      <!-- end checkbox -->

     
  <!-- invalid feedback -->
  <div class="hidden text-sm dark:text-red-500">
    {{value['label']}} is invalid and must match this pattern: {{value['regex']|safe}}
  </div>
  <!--end   invalid feedback -->
        </div>

        {% endif %} {% endfor %}
      </div>
    </div> 
    <!-- end general container -->